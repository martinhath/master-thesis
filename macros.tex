\newcommand{\fixme}[1]{{\color{black}\todo{#1}}}

\newcommand{\egn}[1]{\id{#1}}
\newcommand{\code}[1]{{\color{darkred}\ttfamily #1}}
\newcommand{\mc}[1]{{\ttfamily #1}}
\newcommand{\coderef}[1]{(\texttt{\color{operator}#1})}
\newcommand{\lit}[1]{$\big<\textit{\sffamily #1}\big>$}
\newcommand{\nullptr}{$\bot$}
\newcommand{\typeof}{\::\,:\:}

\newcommand{\rustc}{\code{rustc}}
\newcommand{\cargo}{\code{cargo}}
\newcommand{\rustup}{\code{rustup}}

\newcommand{\lorem}{{\color{black!60}\blindtext{}}}

% name aliases
\newcommand{\gribb}{{Intel\textregistered{} i7--4770}}
\newcommand{\daslab}{{Intel\textregistered{} Xeon\textregistered{} Gold 6150}}
\newcommand{\scaleway}{{Cavium ThunderX}}
\newcommand{\mitserver}{{Intel\textregistered{} Xeon\textregistered{} E7--8870}}


\renewcommand{\mkbegdispquote}[2]{\itshape}%

\tikzset{auto}
\tikzset{lnode/.style={node distance=2.5cm, rectangle split, rectangle
split horizontal, rectangle split parts=2, draw, rounded
corners=0.05cm,font=\footnotesize,fill=white}}
\tikzset{block/.style={regular polygon, regular polygon sides=4, draw, rounded
corners=0.02cm, font=\footnotesize}}
\tikzset{text/.style={regular polygon, regular polygon sides=4 }}
\tikzset{ptr/.style={{Circle[black, length=3pt]}-latex}}
\tikzset{ptr-g/.style={{Circle[lightgray, length=3pt]}-latex}}
% Dotted start for arrows.
\tikzset{
    circlebase/.style={
        decoration={
            markings,
            mark={
                at position 0
                with {
                    \draw [fill] circle [radius=#1];
                }
            }
        },
        postaction=decorate
    },
    circlebase/.default=0.5mm
}



\definecolor{lightblue}{HTML}{AFE0FF}
\definecolor{lightred}{HTML}{FFA0AF}
\definecolor{darkred}{HTML}{A02020}

\definecolor{rust}{HTML}{FFE7C7}
\definecolor{operator}{HTML}{004b84}

\definecolor{theme1}{rgb}{0.5,0.1,0.5}
\definecolor{theme2}{rgb}{0.1,0.5,0.5}
\definecolor{theme3}{rgb}{0.1,0.1,0.5}
\definecolor{none}{rgb}{1.0,1.0,1.0}


\newacronym{ipc}{IPC}{Inter-Process Communication}
\newacronym{tls}{TLS}{Thread-Local Storage}
\newacronym{pthreads}{pthreads}{POSIX threads}
\newacronym{nll}{NLL}{Non-Lexical Lifetimes}
\newacronym{hps}{HPs}{Hazard Pointers}
\newacronym{rfc}{RFC}{Request For Comments}
\newacronym{raii}{RAII}{Resource Allocation Is Initialization}
\newacronym{cow}{CoW}{Copy-on-Write}
\newacronym{ub}{UB}{Undefined Behaviour}


\newcommand{\Operator}[1]{{\color{operator}#1}}

\lstdefinestyle{Algo}{%
  basicstyle=\normalsize\mdseries\itshape,
  columns=flexible,
  xleftmargin=15pt,
  numbers=left,
  keywordstyle={\bf},
  mathescape,
  commentstyle={\color{gray}},
  keywords={for,if,else,return,in,to,while,continue,break,output,not}%
}

\lstdefinestyle{Rust}{%
 backgroundcolor=\color{white},
 basicstyle=\footnotesize\ttfamily,
 columns=flexible,
 keywordstyle=\color{theme1},
 keywords={let,mut,fn,return,pub,struct,where,impl,as,match,not,if,else,loop,while,unsafe,
           default,ref,break,continue,type,trait},
 escapeinside={(*}{*)},
 numbers=none,
 numbersep=5pt,
 numberstyle=\color{gray}\ttfamily,
 showspaces=false,
 showstringspaces=false,
 rulecolor=\color{lightgray},
 literate=
 {(}{{\Operator{(}}}1
 {)}{{\Operator{)}}}1
 {[}{{\Operator{[}}}1
 {]}{{\Operator{]}}}1
 {<}{{\Operator{<}}}1
 {>}{{\Operator{>}}}1
 {+}{{\Operator{+}}}1
 {-}{{\Operator{-}}}1
 {=}{{\Operator{=}}}1
 {;}{{\Operator{;}}}1
 {:}{{\Operator{:}}}1
 {.}{{\Operator{.}}}1
 {)}{{\Operator{)}}}1
 {|}{{\Operator{|}}}1
 {*}{{\Operator{*}}}1
 {!}{{\Operator{!}}}1
 {\&}{{\Operator{\&}}}1
 {\ }{{\Operator{\ }}}1
 {\{}{{\Operator{\{}}}1
 {\}}{{\Operator{\}}}}1,
 stringstyle=\color{green},
}

\newcommand{\hmgrid}[1]{%
  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{graphs/#1-hm-insert}
    \caption{\code{HashMap::insert}}
  \end{subfigure}
  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{graphs/#1-hm-remove}
    \caption{\code{HashMap::remove}}
  \end{subfigure}

  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{graphs/#1-hm-contains}
    \caption{\code{HashMap::contains}}
  \end{subfigure}
  \begin{subfigure}{0.49\textwidth}
    \includegraphics[width=\textwidth]{graphs/#1-hm-80-10-10}
    \caption{\code{HashMap} with 80\% contains, 10\% insert, 10\% remove}
  \end{subfigure}
}
