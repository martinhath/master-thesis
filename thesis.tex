\documentclass[b5paper, twoside, openright]{report}
% \documentclass[b6paper]{report}
% \usepackage[lmargin=25mm, rmargin=25mm, tmargin=27mm, bmargin=30mm]{geometry}
\usepackage[tmargin=27mm, bmargin=30mm]{geometry}

% \usepackage[a4,center,frame]{crop}

\usepackage[T1]{fontenc}
\usepackage[toc]{appendix}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{color}
\usepackage{graphicx}
\usepackage[colorlinks, linkcolor=theme1, linktocpage,
            citecolor=theme2]{hyperref}
\usepackage{footnotebackref}
\usepackage[capitalize, nameinlink]{cleveref}
\crefname{lstlisting}{Listing}{Listings}
\usepackage[colorinlistoftodos,
            textsize=footnotesize,
            linecolor=none,
            bordercolor=none,
            backgroundcolor=none]{todonotes}
% \usepackage{libertinust1math}
\usepackage{euler}
\usepackage{libertine}
\usepackage{inconsolata}
\usepackage{listings}
% \usepackage{parskip}
\usepackage{wrapfig}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{positioning,shapes,decorations,decorations.markings,calc,fit,arrows.meta,backgrounds}
\usepackage[inline,shortlabels]{enumitem}
\usepackage{xcolor}
\usepackage{longtable}
\usepackage[automake,acronym]{glossaries}
\usepackage{titlesec}
\usepackage{blindtext}
\usepackage{microtype}
\usepackage{clrscode3e}

\usepackage{fancyhdr}
%   \fancyhf{}
\fancyhead[LO,RE]{\textsc{\leftmark}}
\fancyhead[RO,LE]{\textsc{\rightmark}}

\titleformat{\part}[display]
  {\center}
  {\Large\scshape{\partname} \thepart}
  {0ex}
  {\Huge}

\titleformat{\chapter}[display]
  {\center}
  {\large\scshape{\chaptertitlename} \thechapter}
  {0ex}
  {\huge}

\titleformat*{\section}{\Large}
\titleformat*{\subsection}{\large}
\titleformat*{\subsubsection}{\bfseries\normalsize}

\catcode`_=12
\begingroup\lccode`~=`_\lowercase{\endgroup\let~\sb}

% Hack to make parskip and amsthm go well together.
% \begingroup
%     \makeatletter
%     \@for\theoremstyle:=definition,remark,plain\do{%
%         \expandafter\g@addto@macro\csname th@\theoremstyle\endcsname{%
%             \addtolength\thm@preskip\parskip
%             }}
% \endgroup

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}

\graphicspath{{./graphics/}}

\makeglossaries{}

\begin{document}

\renewcommand{\thepage}{\roman{page}}%

\begin{titlepage}
  \centering
  \null%
  \vspace{1cm}
  {\Large TDT4900: Masters Thesis \par}
  \vspace{2cm}
  {\huge CMR:\@ A concurrent memory\\ management system for Rust\par}
  \vspace{3cm}
  {\Large\itshape{}Martin Hafskjold Thoresen\par}
  \vfill
  supervised by\par
  {\large Magnus Lie Hetland}\\
  \vspace{2cm}
  {\large \today\\}
\end{titlepage}

\input{macros.tex}

\input{chapters/abstract}

\input{chapters/acknowledgements}


\tableofcontents%
\listoffigures%
% \listoftables%

\listoftodos[Resolve These Things]

\clearpage\null%
\clearpage\setcounter{page}{1}%breakbreak
\renewcommand{\thepage}{\arabic{page}}%

% \part{Bing Bong}


\pagestyle{fancy}

\input{chapters/introduction}

\input{chapters/background.tex}

\input{chapters/rust.tex}

\input{chapters/cmr.tex}


% \part{Abcdef}

\input{chapters/implementation}

\input{chapters/methodology}

\input{chapters/usage}

\input{chapters/results}

\input{chapters/conclusion}

\begin{appendices}
\appendix
  \chapter{Extended Results\label{ap:results}}
\end{appendices}

\printglossary[type=\acronymtype,title=Abbreviations]
\printglossary{}

\bibliographystyle{acm}
\addcontentsline{toc}{chapter}{Bibliography}
\bibliography{sources}


\end{document}
